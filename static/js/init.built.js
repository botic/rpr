/**
 * @license RequireJS domReady 1.0.0 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */
define("lib/domReady",[],function(){function i(a){for(var b=0,d;d=a[b];b++)d(c)}function j(){var a=d,c=e;b&&(a.length&&(d=[],i(a)),f.resourcesDone&&c.length&&(e=[],i(c)))}function k(){b||(b=!0,h&&clearInterval(h),j())}function l(a){return b?a(c):d.push(a),l}var a=typeof window!="undefined"&&window.document,b=!a,c=a?document:null,d=[],e=[],f=requirejs||require||{},g=f.resourcesReady,h;return"resourcesReady"in f&&(f.resourcesReady=function(a){g&&g(a),a&&j()}),a&&(document.addEventListener?(document.addEventListener("DOMContentLoaded",k,!1),window.addEventListener("load",k,!1)):window.attachEvent&&(window.attachEvent("onload",k),self===self.top&&(h=setInterval(function(){try{document.body&&(document.documentElement.doScroll("left"),k())}catch(a){}},30))),document.readyState==="complete"&&k()),l.withResources=function(a){return b&&f.resourcesDone?a(c):e.push(a),l},l.version="1.0.0",l.load=function(a,b,c,d){d.isBuild?c(null):l(c)},l}),define("views/view.package",["require","exports","module"],function(a,b,c){var d=b.PackageView=Backbone.View.extend({tagName:"li",template:"#tmpl-package",events:{"click .menu li":"toggle","click .checksums":"toggleChecksums",click:"toggleTabs"},initialize:function(){this.model.bind("change",this.render,this)}});d.prototype.render=function(){return $(this.el).empty().append($(this.template).tmpl(this.model.toJSON())),this},d.prototype.toggleTabs=function(a){if($(a.target).is("a"))return!0;var b=$(".menu li.expanded",this.el);return b.length==0?$(".menu li:first-child",this.el).trigger("click"):b.length>0&&b.next().length<1?b.trigger("click"):b.next().trigger("click"),!1},d.prototype.toggleChecksums=function(a){var b=$(a.target).toggleClass("expanded");return b.next("dd.checksums").fadeToggle(),!1},d.prototype.toggle=function(a){var b=$(a.target);b.toggleClass("expanded").siblings().removeClass("expanded"),$(this.el).toggleClass("selected",b.hasClass("expanded"));var c=b.parent().nextAll("dl").removeClass("expanded");return b.hasClass("expanded")&&c.filter(b.data("display")).addClass("expanded"),!1}}),define("models/model.version",["require","exports","module"],function(a,b,c){var d=b.Version=Backbone.Model.extend({})}),define("collections/collection.versions",["require","exports","module","models/model.version"],function(a,b,c){var d=a("models/model.version").Version,e=b.Versions=Backbone.Collection.extend({model:d})}),define("models/model.package",["require","exports","module","collections/collection.versions"],function(a,b,c){var d=a("collections/collection.versions").Versions,e=b.Package=Backbone.MappedModel.extend({mapping:{versions:d}})}),define("views/view.list",["require","exports","module","views/view.package","models/model.package"],function(a,b,c){var d=a("views/view.package").PackageView,e=a("models/model.package").Package,f=b.ListView=Backbone.View.extend({el:"#list",$result:$("#result",this.el),$loadmore:$("#loadmore",this.el).hide(),events:{"click #loadmore":"loadMore"},initialize:function(){this.collection.bind("reset",this.clearList,this),this.collection.bind("fetched",this.onLoaded,this)}});f.prototype.clearList=function(){this.$result.empty()},f.prototype.onLoaded=function(){this.$loadmore.removeClass("active");var a=this.collection.rest(this.collection.offset).map(function(a){var b=new d({model:a});return b.render().el});this.$result.append($(a).hide().fadeIn(300)),$(a[0]).addClass("pageborder"),this.$loadmore.toggle(this.collection.hasMore())},f.prototype.loadMore=function(a){a.preventDefault(),this.$loadmore.addClass("active"),this.collection.fetch({add:!0,data:_.extend(this.getUrlParameters(),{o:this.collection.length})})},f.prototype.getUrlParameters=function(){return{q:this.query,l:this.perPage}},f.prototype.search=function(a,b){this.query=a||"",this.perPage=b,this.offset=0,this.collection.fetch({data:this.getUrlParameters()})},f.prototype.single=function(a){(new e).fetch({url:"/packages/"+a+"/",success:$.proxy(function(a){var b=new d({model:a});$(b.render().el).appendTo(this.$result.empty()).addClass("selected").triggerHandler("click")},this)})}}),define("views/view.main",["require","exports","module","views/view.list"],function(a,b,c){var d=a("views/view.list").ListView,e=null,f=b.MainView=Backbone.View.extend({el:"#main",$searchInput:$("#search",this.el),events:{"keyup #search":"handleInput"},initialize:function(){return this.listView=new d({collection:this.collection}),this.collection.bind("fetching",this.onLoading,this),this.collection.bind("fetched",this.onLoaded,this),this.query=this.$searchInput.val(),this}});f.prototype.onLoading=function(){this.$searchInput.addClass("active")},f.prototype.onLoaded=function(){this.$searchInput.removeClass("active")},f.prototype.handleInput=function(a){var b=this.$searchInput.val();a.keyCode===13?(window.clearTimeout(e),window.location.hash="#!/search/"+b):b!=this.query&&(window.clearTimeout(e),e=window.setTimeout($.proxy(function(){this.search(b)},this),500))},f.prototype.setDocTitle=function(){var a=window.document.title;a=a.split(":").slice(0,1),this.query.length>0&&a.push("'"+this.query+"'"),window.document.title=a.join(": ")},f.prototype.search=function(a,b){this.query=a||"",this.$searchInput.val(this.query).focus(),this.setDocTitle(),this.listView.search(this.query,20)},f.prototype.single=function(a){this.query=a||"",this.$searchInput.val("").blur(),this.setDocTitle(),this.listView.single(a)}}),define("collections/collection.packages",["require","exports","module","models/model.package"],function(a,b,c){var d=a("models/model.package").Package,e=b.Packages=Backbone.Collection.extend({url:"/search",model:d,initialize:function(){this.total=0,this.offset=0}});e.prototype.fetch=function(a){typeof a!="undefined"||(a={}),this.trigger("fetching"),a=a||{};var b=a.success;return a.success=function(a,c){a.trigger("fetched"),b&&b(a,c)},Backbone.Collection.prototype.fetch.call(this,a)},e.prototype.hasMore=function(){return this.total>this.length},e.prototype.reset=function(a,b){return this.total=a.length,this.offset=0,Backbone.Collection.prototype.reset.apply(this,arguments)},e.prototype.parse=function(a){return this.total=a.total,this.offset=a.offset,this.perPage=a.length,_.map(a.hits,function(a){return d.prototype.parse.call(null,a)})}}),define("app",["require","exports","module","views/view.main","collections/collection.packages"],function(a,b,c){var d=a("views/view.main").MainView,e=a("collections/collection.packages").Packages,f=b.App=Backbone.Router.extend({routes:{"!/packages/:name":"single","!/search/*q":"search","":"index"},init:function(a){return this.mainView=(new d({collection:new e})).render(),Backbone.history.start(),this}});f.prototype.index=function(){this.mainView.search()},f.prototype.search=function(a){this.mainView.search(a)},f.prototype.single=function(a){this.mainView.single(a)}}),require.config({baseUrl:"js/"}),define("init",["require","exports","module","lib/domReady","app"],function(a,b,c){var d=a("lib/domReady"),e=a("app").App;d(function(){window.app=(new e).init()})})